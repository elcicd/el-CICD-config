ARG JENKINS_OCI_REGISTRY
FROM ${JENKINS_OCI_REGISTRY}/elcicd-jenkins-agent-base

USER root

ARG INSTALL_PKGS="R ShellCheck"
    
COPY requirements.R /tmp/requirements.R

RUN microdnf install -y --nodocs yum-utils && \
    microdnf install -y --nodocs ${INSTALL_PKGS} && \
    Rscript /tmp/requirements.R && \
    chmod -R 775 /usr/lib64/R && \
    microdnf clean all && \
    rm -rf /var/logs/* /tmp/*

USER 1001
