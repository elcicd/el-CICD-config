######################################################################
##
## The following template can be used as is for defining an external Route.
## The Host Name will be automatically defined by el-CICD if not specified
## in your template-defs.json.  The default values include port 8080,
## edge termination, and a weight of 100.
##
######################################################################
apiVersion: v1
kind: Template
labels:
  template: route-template
message: Route template
metadata:
  name:  route-template
objects:
######################################################################
##
## APP_NAME defaults to the microservice name.  You will need to override
## this is you intend to deploy the same image multiple times.
##
######################################################################
- apiVersion: v1
  kind: Route
  metadata:
    labels:
      app: ${APP_NAME}
    name: ${ROUTE_NAME}
  spec:
    host: ${ROUTE_HOST}
    port:
      targetPort: ${{SVC_PORT}}
    tls:
      termination: ${ROUTE_TERMINATION}
    to:
      kind: Service
      name: ${APP_NAME}
      weight: ${{WEIGHT}}
    wildcardPolicy: ${WILDCARD_POLICY}

parameters:
- description: The name for the app; set this value in template-defs.json for multiple deployments of the same image; default value is the microservice name
  displayName: Application Name
  name: APP_NAME
  required: true

- description: |-
    Route hostname; will be set generated by el-CICD if not specified in template-defs.json
    will be automatically modified per SDLC namespace environment for ease of use
  displayName: Route hostname
  name: ROUTE_HOST
  required: true

- description: Service port
  displayName: Service Port
  name: SVC_PORT
  required: true
  value: "8080"

- description: Route termination; see OKD docs for more info
  displayName: Route termination
  name: ROUTE_TERMINATION
  required: true
  value: edge

- description: Weight of route in LB
  displayName: Route weight
  name: WEIGHT
  required: true
  value: "100"

- description: Wildcard policy; see OKD docs for more info
  displayName: Wildcard Policy
  name: WILDCARD_POLICY
  required: true
  value: None
